ungroup()%>%
mutate(Rank=rank(Freq))
All_Rankings <-SpecRanks_2000_LowSal%>%
add_row(SpecRanks_2000_MidSal)%>%
add_row(SpecRanks_2000_HiSal)%>%
add_row(SpecRanks_LowSal)%>%
add_row(SpecRanks_MidSal)%>%
add_row(SpecRanks_HiSal)
Complete_Rankings <- All_Rankings %>% group_by(CommonName)%>%
summarise(TotalRank = sum(Rank),N_Lists=n())%>%arrange(-TotalRank)%>%
filter(CommonName != "Unknown" & N_Lists>1)
Working_Long <- Long_Master %>% filter(CommonName %in% c(Complete_Rankings$CommonName,"Crangon"))
Working_Tow <- Working_Long %>%
mutate(Date_Tow = paste(SampleDate,"_",TowNumber))%>%
group_by(StationCode,SurveySeason,SacWYType,Season)%>%
mutate(N_Tows = length(unique(Date_Tow)))%>%ungroup()%>%
group_by(StationCode,SurveySeason,SacWYType,Season,CommonName)%>%
mutate(TotalCatch = n())%>%ungroup()%>%
group_by(Subregion,SurveySeason,SacWYType,Season,CommonName,TotalCatch)%>%
summarise(TotalCatch=sum(TotalCatch))%>%
mutate(CPT = TotalCatch/N_Tows)
Working_Tow <- Working_Long %>%
mutate(Date_Tow = paste(SampleDate,"_",TowNumber))%>%
group_by(StationCode,SurveySeason,SacWYType,Season)%>%
mutate(N_Tows = length(unique(Date_Tow)))%>%ungroup()%>%
group_by(StationCode,SurveySeason,SacWYType,Season,CommonName)%>%
mutate(TotalCatch = n())%>%ungroup()%>%
group_by(SubRegion,SurveySeason,SacWYType,Season,CommonName,TotalCatch)%>%
summarise(TotalCatch=sum(TotalCatch))%>%
mutate(CPT = TotalCatch/N_Tows)
Working_Tow <- Working_Long %>%
mutate(Date_Tow = paste(SampleDate,"_",TowNumber))%>%
group_by(StationCode,SurveySeason,SacWYType,Season)%>%
mutate(N_Tows = length(unique(Date_Tow)))%>%ungroup()%>%
group_by(StationCode,SurveySeason,SacWYType,Season,CommonName)%>%
mutate(TotalCatch = n())%>%ungroup()%>%
group_by(SubRegion,SurveySeason,SacWYType,Season,CommonName,TotalCatch,N_Tows)%>%
summarise(TotalCatch=sum(TotalCatch))%>%
mutate(CPT = TotalCatch/N_Tows)
Working_Tow <- Working_Long %>%
mutate(Date_Tow = paste(SampleDate,"_",TowNumber))%>%
group_by(SubRegion,SurveySeason,SacWYType,Season)%>%
mutate(N_Tows = length(unique(Date_Tow)))%>%ungroup()%>%
group_by(Subregion,SurveySeason,SacWYType,Season,CommonName,N_Tows)%>%
summarise(TotalCatch = n())%>%
mutate(CPT = TotalCatch/N_Tows)
Working_Tow <- Working_Long %>%
mutate(Date_Tow = paste(SampleDate,"_",TowNumber))%>%
group_by(SubRegion,SurveySeason,SacWYType,Season)%>%
mutate(N_Tows = length(unique(Date_Tow)))%>%ungroup()%>%
group_by(SubRegion,SurveySeason,SacWYType,Season,CommonName,N_Tows)%>%
summarise(TotalCatch = n())%>%
mutate(CPT = TotalCatch/N_Tows)
View(Working_Tow)
Working_Tow <- Working_Long %>%
mutate(Date_Tow = paste(SampleDate,"_",TowNumber))%>%
group_by(SubRegion,SurveySeason,SacWYType,Season)%>%
mutate(N_Tows = length(unique(Date_Tow)))%>%ungroup()%>%
group_by(SubRegion,SurveySeason,SacWYType,Season,CommonName,N_Tows)%>%
summarise(TotalCatch = n())%>%
mutate(CPT = rounc(TotalCatch/N_Tows),2)
Working_Tow <- Working_Long %>%
mutate(Date_Tow = paste(SampleDate,"_",TowNumber))%>%
group_by(SubRegion,SurveySeason,SacWYType,Season)%>%
mutate(N_Tows = length(unique(Date_Tow)))%>%ungroup()%>%
group_by(SubRegion,SurveySeason,SacWYType,Season,CommonName,N_Tows)%>%
summarise(TotalCatch = n())%>%
mutate(CPT = round(TotalCatch/N_Tows),2)
View(Working_Tow)
Working_Tow <- Working_Long %>%
mutate(Date_Tow = paste(SampleDate,"_",TowNumber))%>%
group_by(SubRegion,SurveySeason,SacWYType,Season)%>%
mutate(N_Tows = length(unique(Date_Tow)))%>%ungroup()%>%
group_by(SubRegion,SurveySeason,SacWYType,Season,CommonName,N_Tows)%>%
summarise(TotalCatch = n())%>%
mutate(CPT = round(TotalCatch/N_Tows,2))
View(Working_Tow)
Working_Tow <- Working_Long %>%
mutate(Date_Tow = paste(SampleDate,"_",TowNumber))%>%
group_by(SubRegion,SacWYType,Season)%>%
mutate(N_Tows = length(unique(Date_Tow)))%>%ungroup()%>%
group_by(SubRegion,SacWYType,Season,CommonName,N_Tows)%>%
summarise(TotalCatch = n())%>%
mutate(CPT = round(TotalCatch/N_Tows,2))
View(Working_Tow)
Working_Long %>%
mutate(Date_Tow = paste(SampleDate,"_",TowNumber))%>%
group_by(SubRegion,SacWYType,Season)%>%
mutate(N_Tows = length(unique(Date_Tow)))%>%ungroup()%>%
group_by(SubRegion,SacWYType,Season,CommonName,N_Tows)%>%
summarise(TotalCatch = n())%>%
mutate(CPT = round(TotalCatch/N_Tows,2))%>%
ggplot(aes(y=CommonName,x=CPT,fill=Season))+geom_bar(stat="identity")
table(is.na(Long_Master$Season))
Long_Master %>% filter(is.na(Season)==T)%>%group_by(Year)%>%summarise(n())
Long_Master %>% filter(is.na(Season)==T)%>%group_by(SurveySeason)%>%summarise(n())
Working_Long %>%filter(is.na(Season)==F)%>%
mutate(Date_Tow = paste(SampleDate,"_",TowNumber))%>%
group_by(SubRegion,SacWYType,Season)%>%
mutate(N_Tows = length(unique(Date_Tow)))%>%ungroup()%>%
group_by(SubRegion,SacWYType,Season,CommonName,N_Tows)%>%
summarise(TotalCatch = n())%>%
mutate(CPT = round(TotalCatch/N_Tows,2))%>%
ggplot(aes(y=CommonName,x=CPT,fill=Season))+geom_bar(stat="identity")
5000000/81000
Working_Long %>%filter(is.na(Season)==F)%>%
mutate(Date_Tow = paste(SampleDate,"_",TowNumber))%>%
group_by(SubRegion,SacWYType,Season)%>%
mutate(N_Tows = length(unique(Date_Tow)))%>%ungroup()%>%
group_by(SubRegion,SacWYType,Season,CommonName,N_Tows)%>%
summarise(TotalCatch = n())%>%
mutate(CPT = round(TotalCatch/N_Tows,2))%>%
ggplot(aes(y=CommonName,x=CPT,fill=Season))+geom_bar(stat="identity")+
facet_wrap(~SubRegion)
Working_Tow <- Working_Long %>%
ungroup()%>%
distinct(across(c(Survey_Station,SampleDate,TowNumber,CommonName,ForkLength)),.keep_all = TRUE)%>%
mutate(ForkLength = na_if(ForkLength,0))%>%
group_by(Survey_Station,SampleDate,TowNumber,CommonName)%>%
mutate(Length_Mean = mean(ForkLength,na.rm = T),
Length_Var = var(ForkLength, na.rm=T))%>%
ungroup%>%
group_by(Survey_Station,SampleDate,TowNumber)%>%
mutate(MaxLength = max(ForkLength,na.rm = T),
Q75Length = quantile(ForkLength,.75,na.rm=T),
MedianLength = median(ForkLength, na.rm=T),
Q25Length = quantile(ForkLength,.25,na.rm=T),
MinLength = min(ForkLength, na.rm=T))%>%
ungroup()%>%
distinct(across(c(Survey_Station,SampleDate,TowNumber,CommonName)),.keep_all = TRUE)%>%
select(-c(LengthFrequency,Family:Species,ForkLength:Dead,ReproductiveStage:Sex,OrganismCodeFMWT,OrganismCategory))
View(Working_Long)
View(Working_Tow)
Working_Tow <- Working_Long %>%
distinct(across(c(Survey_Station,SampleDate,TowNumber,CommonName)),.keep_all = TRUE)%>%
select(-c(LengthFrequency,Family:Species,ForkLength:Dead,ReproductiveStage:Sex,OrganismCodeFMWT,OrganismCategory))
View(Working_Tow)
Working_Tow <- Working_Long %>%
distinct(across(c(Survey_Station,SampleDate,TowNumber,CommonName)),.keep_all = TRUE)%>%
select(-c(LengthFrequency,Family:Species,ForkLength:Dead,ReproductiveStage:Sex,OrganismCodeFMWT,OrganismCategory))%>%
ggplot(aes(y=CommonName,x=Catch))+facet_wrap(SubRegion)
Working_Tow %>% ggplot(aes(y=CommonName,x=Catch))+facet_wrap(SubRegion)
names(Working_Tow)
Working_Tow %>% ggplot(aes(y=CommonName,x=Catch))+facet_wrap(~SubRegion)
Working_Tow %>% ggplot(aes(y=CommonName,x=Catch))+geom_boxplot()+facet_wrap(~SubRegion)
Working_Tow %>%
filter(CommonName == "Delta_Smelt")%>%
ggplot(aes(x=Catch))+geom_histogram()+facet_wrap(~SubRegion)
Working_Tow %>%
group_by(SubRegion)%>%
mutate(Mean_Cond = mean(ConductivityTop,na.rm=T))%>%
ungroup()%>%
arrange(-Mean_Cond)%>%
mutate(SubRegion=factor(SubRegion, levels=unique(SubRegion)))%>%
filter(CommonName == "Delta_Smelt")%>%
ggplot(aes(x=Catch))+geom_histogram()+facet_wrap(~SubRegion)
Working_Tow %>%
group_by(SubRegion)%>%
mutate(Mean_Cond = mean(ConductivityTop,na.rm=T))%>%
ungroup()%>%
arrange(-Mean_Cond)%>%
mutate(SubRegion=factor(SubRegion, levels=unique(SubRegion)))%>%
filter(CommonName == "Delta_Smelt")%>%
ggplot(aes(x=Catch))+geom_histogram()+facet_wrap(~SubRegion)+theme_bw()+
xlim(c(0,250))
Working_Tow %>%
group_by(SubRegion)%>%
mutate(Mean_Cond = mean(ConductivityTop,na.rm=T))%>%
ungroup()%>%
arrange(-Mean_Cond)%>%
mutate(SubRegion=factor(SubRegion, levels=unique(SubRegion)))%>%
filter(CommonName == "Delta_Smelt")%>%
ggplot(aes(x=Catch))+geom_histogram()+facet_wrap(~SubRegion)+theme_bw()+
xlim(c(-.5,250))
Working_Tow %>%
group_by(SubRegion)%>%
mutate(Mean_Cond = mean(ConductivityTop,na.rm=T))%>%
ungroup()%>%
arrange(-Mean_Cond)%>%
mutate(SubRegion=factor(SubRegion, levels=unique(SubRegion)))%>%
filter(CommonName == "Delta_Smelt")%>%
ggplot(aes(x=Catch))+geom_histogram()+facet_wrap(~SubRegion)+theme_bw()+
xlim(c(-.1,250))
Working_Tow %>%
group_by(SubRegion)%>%
mutate(Mean_Cond = mean(ConductivityTop,na.rm=T))%>%
ungroup()%>%
arrange(-Mean_Cond)%>%
mutate(SubRegion=factor(SubRegion, levels=unique(SubRegion)))%>%
filter(CommonName == "Delta_Smelt")%>%
ggplot(aes(x=Catch))+geom_histogram()+facet_wrap(~SubRegion)+theme_bw()
Working_Tow %>%
group_by(SubRegion)%>%
mutate(Mean_Cond = mean(ConductivityTop,na.rm=T))%>%
ungroup()%>%
arrange(-Mean_Cond)%>%
mutate(SubRegion=factor(SubRegion, levels=unique(SubRegion)))%>%
filter(CommonName == "Delta_Smelt")%>%
ggplot(aes(x=Catch))+geom_histogram()+facet_wrap(~SubRegion,scales="free_x")+theme_bw()
Working_Tow %>%
group_by(SubRegion)%>%
mutate(Mean_Cond = mean(ConductivityTop,na.rm=T))%>%
ungroup()%>%
arrange(-Mean_Cond)%>%
mutate(SubRegion=factor(SubRegion, levels=unique(SubRegion)))%>%
filter(CommonName == "Delta_Smelt")%>%
ggplot(aes(x=Catch))+geom_density()+facet_wrap(~SubRegion)+theme_bw()
Working_Tow %>%
group_by(SubRegion)%>%
mutate(Mean_Cond = mean(ConductivityTop,na.rm=T))%>%
ungroup()%>%
arrange(-Mean_Cond)%>%
mutate(SubRegion=factor(SubRegion, levels=unique(SubRegion)))%>%
filter(CommonName == "Delta_Smelt")%>%
ggplot(aes(x=Catch))+geom_density(stat="identity")+facet_wrap(~SubRegion)+theme_bw()
Working_Tow %>%
group_by(SubRegion)%>%
mutate(Mean_Cond = mean(ConductivityTop,na.rm=T))%>%
ungroup()%>%
arrange(-Mean_Cond)%>%
mutate(SubRegion=factor(SubRegion, levels=unique(SubRegion)))%>%
filter(CommonName == "Delta_Smelt")%>%
ggplot(aes(x=Catch))+geom_histogram(stat="density")+facet_wrap(~SubRegion)+theme_bw()
Working_Tow %>%
group_by(SubRegion)%>%
mutate(Mean_Cond = mean(ConductivityTop,na.rm=T))%>%
ungroup()%>%
arrange(-Mean_Cond)%>%
mutate(SubRegion=factor(SubRegion, levels=unique(SubRegion)))%>%
filter(CommonName == "Delta_Smelt")%>%
ggplot(aes(x=Catch))+geom_histogram(position="identity")+facet_wrap(~SubRegion)+theme_bw()
Working_Tow %>%
group_by(SubRegion)%>%
mutate(Mean_Cond = mean(ConductivityTop,na.rm=T))%>%
ungroup()%>%
arrange(-Mean_Cond)%>%
mutate(SubRegion=factor(SubRegion, levels=unique(SubRegion)))%>%
filter(CommonName == "Delta_Smelt")%>%
ggplot(aes(x=Catch))+geom_histogram(position="identity",bins=40)+facet_wrap(~SubRegion)+theme_bw()
Working_Tow %>%
group_by(SubRegion)%>%
mutate(Mean_Cond = mean(ConductivityTop,na.rm=T))%>%
ungroup()%>%
arrange(-Mean_Cond)%>%
mutate(SubRegion=factor(SubRegion, levels=unique(SubRegion)))%>%
filter(CommonName == "Delta_Smelt" & Catch <250)%>%
ggplot(aes(x=Catch))+geom_histogram(position="identity",bins=40)+facet_wrap(~SubRegion)+theme_bw()
Working_Tow %>%
group_by(SubRegion)%>%
mutate(Mean_Cond = mean(ConductivityTop,na.rm=T))%>%
ungroup()%>%
arrange(-Mean_Cond)%>%
mutate(SubRegion=factor(SubRegion, levels=unique(SubRegion)))%>%
filter(CommonName == "Northern_Anchovy")%>%
ggplot(aes(x=Catch))+geom_histogram(position="identity",bins=40)+facet_wrap(~SubRegion)+theme_bw()
Working_Tow %>%
group_by(SubRegion)%>%
mutate(Mean_Cond = mean(ConductivityTop,na.rm=T))%>%
ungroup()%>%
arrange(-Mean_Cond)%>%
mutate(SubRegion=factor(SubRegion, levels=unique(SubRegion)))%>%
filter(CommonName == "Northern_Anchovy")%>%
ggplot(aes(x=Catch,y=SubRegion))+geom_boxplot()
Working_Tow %>%
group_by(SubRegion)%>%
mutate(Mean_Cond = mean(ConductivityTop,na.rm=T))%>%
ungroup()%>%
arrange(-Mean_Cond)%>%
mutate(SubRegion=factor(SubRegion, levels=unique(SubRegion)))%>%
ggplot(aes(x=Catch,y=SubRegion))+geom_boxplot()+theme_bw()+facet_wrap(~CommonName,scales="free_x")
Working_Tow %>%
group_by(SubRegion)%>%
mutate(Mean_Cond = mean(ConductivityTop,na.rm=T))%>%
ungroup()%>%
arrange(-Mean_Cond)%>%
mutate(SubRegion=factor(SubRegion, levels=unique(SubRegion)))%>%
ggplot(aes(x=log(Catch),y=SubRegion))+geom_boxplot()+theme_bw()+facet_wrap(~CommonName,scales="free_x")
#Load libraries:
require(ggforce)
Working_Tow %>%
group_by(SubRegion)%>%
mutate(Mean_Cond = mean(ConductivityTop,na.rm=T))%>%
ungroup()%>%
arrange(-Mean_Cond)%>%
mutate(SubRegion=factor(SubRegion, levels=unique(SubRegion)))%>%
ggplot(aes(x=log(Catch),y=SubRegion))+geom_boxplot()+theme_bw()+
facet_wrap_paginate(~CommonName,scales="free_x",nrow=3,ncol=5,page=1)
Working_Tow %>%
group_by(SubRegion)%>%
mutate(Mean_Cond = mean(ConductivityTop,na.rm=T))%>%
ungroup()%>%
arrange(-Mean_Cond)%>%
mutate(SubRegion=factor(SubRegion, levels=unique(SubRegion)))%>%
ggplot(aes(x=Catch,y=SubRegion))+geom_boxplot()+theme_bw()+
facet_wrap_paginate(~CommonName,scales="free_x",nrow=3,ncol=5,page=1)
Working_Tow %>%
group_by(SubRegion)%>%
mutate(Mean_Cond = mean(ConductivityTop,na.rm=T))%>%
ungroup()%>%
arrange(-Mean_Cond)%>%
mutate(SubRegion=factor(SubRegion, levels=unique(SubRegion)))%>%
ggplot(aes(x=Catch,y=SubRegion))+geom_boxplot()+theme_bw()+
facet_wrap_paginate(~CommonName,scales="free_x",nrow=3,ncol=5,page=2)
Working_Tow %>%
group_by(SubRegion)%>%
mutate(Mean_Cond = mean(ConductivityTop,na.rm=T))%>%
ungroup()%>%
arrange(-Mean_Cond)%>%
mutate(SubRegion=factor(SubRegion, levels=unique(SubRegion)))%>%
ggplot(aes(x=Catch,y=SubRegion,fill=Depth_Cat,col=Depth_Cat))+geom_boxplot()+theme_bw()+
facet_wrap_paginate(~CommonName,scales="free_x",nrow=3,ncol=1,page=2)
table(Working_Tow$Depth_Cat,Working_Tow$SubRegion)
table(Working_Tow$SubRegion,Working_Tow$Depth_Cat)
Working_Tow %>%
group_by(SubRegion)%>%
mutate(Mean_Cond = mean(ConductivityTop,na.rm=T))%>%
ungroup()%>%
arrange(-Mean_Cond)%>%
mutate(SubRegion=factor(SubRegion, levels=unique(SubRegion)))%>%
ggplot(aes(x=Catch,y=SubRegion,fill=Depth_Cat,col=Depth_Cat))+geom_boxplot()+theme_bw()+
facet_wrap_paginate(~CommonName,scales="free_x",nrow=1,ncol=3,page=2)
Working_Tow %>%
group_by(SubRegion)%>%
mutate(Mean_Cond = mean(ConductivityTop,na.rm=T))%>%
ungroup()%>%
arrange(-Mean_Cond)%>%
mutate(SubRegion=factor(SubRegion, levels=unique(SubRegion)))%>%
ggplot(aes(x=Catch,y=SubRegion,fill=Depth_Cat,col=Season))+geom_boxplot()+theme_bw()+
facet_wrap_paginate(~CommonName,scales="free_x",nrow=1,ncol=3,page=2)
Working_Tow %>%
group_by(SubRegion)%>%
mutate(Mean_Cond = mean(ConductivityTop,na.rm=T))%>%
ungroup()%>%
arrange(-Mean_Cond)%>%
mutate(SubRegion=factor(SubRegion, levels=unique(SubRegion)))%>%
ggplot(aes(x=Catch,y=SubRegion,fill=Season,col=Season))+geom_boxplot()+theme_bw()+
facet_wrap_paginate(~CommonName,scales="free_x",nrow=1,ncol=3,page=2)
Working_Tow %>%
group_by(SubRegion)%>%filter(is.na(Season)==F)%>%
mutate(Mean_Cond = mean(ConductivityTop,na.rm=T))%>%
ungroup()%>%
arrange(-Mean_Cond)%>%
mutate(SubRegion=factor(SubRegion, levels=unique(SubRegion)))%>%
ggplot(aes(x=Catch,y=SubRegion,fill=Season,col=Season))+geom_boxplot()+theme_bw()+
facet_wrap_paginate(~CommonName,scales="free_x",nrow=1,ncol=3,page=2)
Catch_Season_Region <-  Working_Tow %>%
group_by(SubRegion)%>%filter(is.na(Season)==F)%>%
mutate(Mean_Cond = mean(ConductivityTop,na.rm=T))%>%
ungroup()%>%
arrange(-Mean_Cond)%>%
mutate(SubRegion=factor(SubRegion, levels=unique(SubRegion)))%>%
ggplot(aes(x=Catch,y=SubRegion,fill=Season,col=Season))+geom_boxplot()+theme_bw()+
facet_wrap_paginate(~CommonName,scales="free_x",nrow=1,ncol=3)
n_pages(Catch_Season_Region)
Catch_Season_Region
print(Catch_Season_Region + facet_wrap_paginate(~CommonName,scales="free_x",nrow=1,ncol=3,page=i))
for(i in 1:10){
print(Catch_Season_Region + facet_wrap_paginate(~CommonName,scales="free_x",nrow=1,ncol=3,page=i))
}
Catch_Season_Region <-  Working_Tow %>%
group_by(SubRegion)%>%filter(is.na(Season)==F)%>%
mutate(Mean_Cond = mean(ConductivityTop,na.rm=T))%>%
ungroup()%>%
arrange(-Mean_Cond)%>%
mutate(SubRegion=factor(SubRegion, levels=unique(SubRegion)))%>%
ggplot(aes(x=Catch,y=SubRegion,fill=Season,col=Season))+geom_boxplot(alpha=.5)+theme_bw()+
facet_wrap_paginate(~CommonName,scales="free_x",nrow=1,ncol=3)+
scale_color_viridis_d()+
scale_fill_viridis_d()
for(i in 1:6){
print(Catch_Season_Region + facet_wrap_paginate(~CommonName,scales="free_x",nrow=2,ncol=3,page=i))
}
Working_Tow %>%
group_by(SubRegion)%>%
mutate(Mean_Cond = mean(ConductivityTop,na.rm=T))%>%
ungroup()%>%
arrange(-Mean_Cond)%>%
mutate(SubRegion=factor(SubRegion, levels=unique(SubRegion)))%>%
ggplot(aes(x=Catch,y=SubRegion))+geom_boxplot()+theme_bw()+
facet_wrap_paginate(~CommonName,scales="free_x",nrow=3,ncol=5,page=1)
Working_Tow <- Working_Long %>%
distinct(across(c(Survey_Station,SampleDate,TowNumber,CommonName)),.keep_all = TRUE)%>%
select(-c(LengthFrequency,Family:Species,ForkLength:Dead,ReproductiveStage:Sex,OrganismCodeFMWT,OrganismCategory))%>%
group_by(SubRegion)%>%
mutate(Mean_Cond = mean(ConductivityTop,na.rm=T))%>%
ungroup()%>%
arrange(-Mean_Cond)%>%
mutate(SubRegion=factor(SubRegion, levels=unique(SubRegion)))
Working_Tow %>% group_by(SubRegion,Season)%>%
mutate(N_Tows = n())%>%
ungroup()%>%ggplot(y=SubRegion,x=N_Tows,col=Season)+geom_line()
Working_Tow %>% group_by(SubRegion,Season)%>%
mutate(N_Tows = n())%>%
ungroup()%>%ggplot(aes(y=SubRegion,x=N_Tows,col=Season))+geom_line()
Working_Tow %>% group_by(SubRegion,Season)%>%
mutate(N_Tows = n())%>%
ungroup()%>%ggplot(aes(y=SubRegion,x=N_Tows,col=Season))+geom_point()
Working_Tow %>% group_by(SubRegion,Season)%>%
mutate(N_Tows = n())%>%
ungroup()%>%ggplot(aes(y=SubRegion,x=N_Tows,col=Season))+geom_point()+
scale_color_viridis_d()
Working_Tow %>% group_by(SubRegion,Season)%>%
mutate(N_Tows = n())%>%filter(is.na(Season)==F)%>%
ungroup()%>%ggplot(aes(y=SubRegion,x=N_Tows,col=Season))+geom_bar()+
scale_color_viridis_d()
Working_Tow %>% group_by(SubRegion,Season)%>%distinct(across(c(Subregion,N_Tows,Season)))%>%
mutate(N_Tows = n())%>%filter(is.na(Season)==F)%>%
ungroup()%>%ggplot(aes(y=SubRegion,x=N_Tows,col=Season))+geom_bar()+
scale_color_viridis_d()
Working_Tow %>% group_by(SubRegion,Season)%>%distinct(across(c(SubRegion,N_Tows,Season)))%>%
mutate(N_Tows = n())%>%filter(is.na(Season)==F)%>%
ungroup()%>%ggplot(aes(y=SubRegion,x=N_Tows,col=Season))+geom_bar()+
scale_color_viridis_d()
Working_Tow %>%
filter(is.na(Season)==F)%>%
group_by(SubRegion,Season)%>%
mutate(N_Tows = n())%>%
ungroup()%>%distinct(across(c(SubRegion,N_Tows,Season)))%>%
ggplot(aes(y=SubRegion,x=N_Tows,col=Season))+geom_bar()+
scale_color_viridis_d()
Working_Tow %>%
filter(is.na(Season)==F)%>%
group_by(SubRegion,Season)%>%
mutate(N_Tows = n())%>%
ungroup()%>%distinct(across(c(SubRegion,N_Tows,Season)))%>%
ggplot(aes(y=SubRegion,x=N_Tows,col=Season))+geom_bar(stat="identity")+
scale_color_viridis_d()
Working_Tow %>%
filter(is.na(Season)==F)%>%
group_by(SubRegion,Season)%>%
mutate(N_Tows = n())%>%
ungroup()%>%distinct(across(c(SubRegion,N_Tows,Season)))%>%
ggplot(aes(y=SubRegion,x=N_Tows,col=Season,fill=Season))+geom_bar(stat="identity",position="dodge")+
scale_color_viridis_d()
Working_Tow %>%
filter(is.na(Season)==F)%>%
group_by(SubRegion,Season)%>%
mutate(N_Tows = n())%>%
ungroup()%>%distinct(across(c(SubRegion,N_Tows,Season)))%>%
ggplot(aes(y=SubRegion,x=N_Tows,col=Season,fill=Season))+geom_bar(stat="identity",position="dodge")+
scale_color_viridis_d()+scale_fill_viridis_d()
Working_Tow %>%
filter(is.na(Season)==F & is.na(SacWYType)==F)%>%
group_by(SubRegion,Season)%>%
mutate(N_Tows = n())%>%
ungroup()%>%
distinct(across(c(SubRegion,N_Tows,Season,SacWYType)))%>%
ggplot(aes(y=SubRegion,x=N_Tows,col=Season,fill=Season))+geom_bar(stat="identity",position="dodge")+
scale_color_viridis_d()+scale_fill_viridis_d()+facet_grid(~SacWYType)
Working_Tow %>%
filter(is.na(Season)==F & is.na(SacWYType)==F)%>%
group_by(SubRegion,Season,SacWYType)%>%
mutate(N_Tows = n())%>%
ungroup()%>%
distinct(across(c(SubRegion,N_Tows,Season,SacWYType)))%>%
ggplot(aes(y=SubRegion,x=N_Tows,col=Season,fill=Season))+geom_bar(stat="identity",position="dodge")+
scale_color_viridis_d()+scale_fill_viridis_d()+facet_grid(~SacWYType)
Working_Tow %>%
filter(is.na(Season)==F & is.na(SacWYType)==F)%>%
group_by(SubRegion,Season,SacWYType)%>%
mutate(N_Tows = n())%>%
ungroup()%>%
distinct(across(c(SubRegion,N_Tows,Season,SacWYType)))%>%
ggplot(aes(y=SubRegion,x=N_Tows,col=Season,fill=Season))+geom_bar(stat="identity",position="dodge",alpha=0.5)+
scale_color_viridis_d()+scale_fill_viridis_d()+facet_grid(~SacWYType)+theme_bw()
# Number of Tows by Season, Subregion and Depth Strata
Working_Tow %>%
filter(is.na(Season)==F & is.na(Depth_Cat)==F)%>%
group_by(SubRegion,Season,Depth_Cat)%>%
mutate(N_Tows = n())%>%
ungroup()%>%
distinct(across(c(SubRegion,N_Tows,Season,Depth_Cat)))%>%
ggplot(aes(y=SubRegion,x=N_Tows,col=Season,fill=Season))+geom_bar(stat="identity",position="dodge",alpha=0.5)+
scale_color_viridis_d()+scale_fill_viridis_d()+facet_grid(~Depth_Cat)+theme_bw()
Working_Tow <- Working_Long %>%
distinct(across(c(Survey_Station,SampleDate,TowNumber,CommonName)),.keep_all = TRUE)%>%
select(-c(LengthFrequency,Family:Species,ForkLength:Dead,ReproductiveStage:Sex,OrganismCodeFMWT,OrganismCategory))%>%
group_by(SubRegion)%>%
mutate(Mean_Cond = mean(ConductivityTop,na.rm=T))%>%
ungroup()%>%
arrange(-Mean_Cond)%>%
mutate(
Depth_Cat = factor(Depth_Cat, levels = c("very deep","deep","intermediat","shallow")),
SubRegion=factor(SubRegion, levels=unique(SubRegion)))
# Number of Tows by Season, Subregion and Depth Strata
Working_Tow %>%
filter(is.na(Season)==F & is.na(Depth_Cat)==F)%>%
group_by(SubRegion,Season,Depth_Cat)%>%
mutate(N_Tows = n())%>%
ungroup()%>%
distinct(across(c(SubRegion,N_Tows,Season,Depth_Cat)))%>%
ggplot(aes(y=SubRegion,x=N_Tows,col=Season,fill=Season))+geom_bar(stat="identity",position="dodge",alpha=0.5)+
scale_color_viridis_d()+scale_fill_viridis_d()+facet_grid(~Depth_Cat)+theme_bw()
Working_Tow <- Working_Long %>%
distinct(across(c(Survey_Station,SampleDate,TowNumber,CommonName)),.keep_all = TRUE)%>%
select(-c(LengthFrequency,Family:Species,ForkLength:Dead,ReproductiveStage:Sex,OrganismCodeFMWT,OrganismCategory))%>%
group_by(SubRegion)%>%
mutate(Mean_Cond = mean(ConductivityTop,na.rm=T))%>%
ungroup()%>%
arrange(-Mean_Cond)%>%
mutate(
Depth_Cat = factor(Depth_Cat, levels = c("very deep","deep","intermediate","shallow")),
SubRegion=factor(SubRegion, levels=unique(SubRegion)))
# Number of Tows by Season, Subregion and Depth Strata
Working_Tow %>%
filter(is.na(Season)==F & is.na(Depth_Cat)==F)%>%
group_by(SubRegion,Season,Depth_Cat)%>%
mutate(N_Tows = n())%>%
ungroup()%>%
distinct(across(c(SubRegion,N_Tows,Season,Depth_Cat)))%>%
ggplot(aes(y=SubRegion,x=N_Tows,col=Season,fill=Season))+geom_bar(stat="identity",position="dodge",alpha=0.5)+
scale_color_viridis_d()+scale_fill_viridis_d()+facet_grid(~Depth_Cat)+theme_bw()
